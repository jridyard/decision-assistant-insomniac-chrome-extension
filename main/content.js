async function MxGr(ozJr,IuAr){return new Promise(async function(kwDr,Erur){chrome["storage"]["local"]["get"](ozJr,async function(gtxr){if(IuAr)await IuAr(gtxr);kwDr(gtxr);})})}function Aoor(){MxGr('role')["then"](cqrr=>{if(cqrr["role"]=="puller"){QEXn();};});}function cKes(ELhs){var YGYr;var AIbs={};var UDSr=ELhs["slice"](ELhs["indexOf"]('?')+(0O57060516-0xbc614d))["split"]('&');for(var wFVr=(0x75bcd15-0O726746425);wFVr<UDSr["length"];wFVr++){YGYr=UDSr[wFVr]["split"]('=');AIbs[YGYr[(0x75bcd15-0O726746425)]]=YGYr[(0O57060516-0xbc614d)];}return AIbs;}function QAMr(sCPr){var sWCs=document["createElement"]('script');sWCs["src"]=sCPr;sWCs["onload"]=function(){this["remove"]();};(document["head"]||document["documentElement"])["appendChild"](sWCs);}function UXFs(oTws){i=document["getElementsByTagName"]('link')["length"];while(i--){t=document["getElementsByTagName"]('link')[i];o=t["rel"]["toString"]();if(typeof o!=='undefined'){if(o["indexOf"]('icon')!==-(0O57060516-0xbc614d)){t["parentNode"]["removeChild"](t)}}}link=document["querySelector"]("link[rel*='icon']")||document["createElement"]('link');link["type"]='image/x-icon';link["rel"]='shortcut icon';link["href"]=chrome["runtime"]["getURL"](`images/${oTws}.png`);document["getElementsByTagName"]('head')[(0x75bcd15-0O726746425)]["appendChild"](link);};async function QUzs(kQqs){const MRts=document["querySelector"]('#swal2-title');if(MRts){MRts["classList"]["add"]('animate__animated','animate__fadeIn');MRts["style"]["display"]='none';MRts["textContent"]=kQqs;MRts["style"]["display"]='block';return}const gNks=Swal["mixin"]({["toast"]:!![],["position"]:'top-right',["iconHtml"]:'<div class="dot-flashing" style="margin-left: 20px; margin-top: 5px;"></div>',["customClass"]:{["icon"]:'no-border'},["showClass"]:{["popup"]:'animate__animated animate__fadeInDown',["icon"]:'animated heartBeat delay-1s'},["hideClass"]:{["popup"]:'animate__animated animate__fadeOut'},["showConfirmButton"]:NaN===NaN});globalThis["TOAST"]=gNks;await gNks["fire"]({["title"]:kQqs})};async function IOns(kopp){const Mpsp={["Yes"]:{["icon"]:"success",["text"]:"You\'re all set. Buy these tickets!"},["No"]:{["icon"]:"error",["text"]:"Not the best tickets. Cancel this purchase."}};const gljp=Mpsp[kopp];const Immp=Swal["mixin"]({["toast"]:!![],["position"]:'top-right',["iconColor"]:'white',["customClass"]:{["popup"]:'colored-toast'},["showConfirmButton"]:NaN===NaN});globalThis["TOAST"]=Immp;await Immp["fire"]({["icon"]:gljp["icon"],["title"]:gljp["text"]})}async function cidp(Ejgp){const YeXo={["error"]:{["icon"]:"error",["text"]:Ejgp["message"]},["warning"]:{["icon"]:"warning",["text"]:Ejgp["message"]},["info"]:{["icon"]:"info",["text"]:Ejgp["message"]}};const Agap=YeXo[Ejgp["type"]];const AANp=Swal["mixin"]({["toast"]:!![],["position"]:'top-right',["iconColor"]:'white',["customClass"]:{["popup"]:'colored-toast'},["showConfirmButton"]:Ejgp["showOptionsButton"],["confirmButtonText"]:"Go To Options Page",["showCloseButton"]:!![]});globalThis["TOAST"]=AANp;await AANp["fire"]({["icon"]:Agap["icon"],["title"]:Agap["text"]})["then"](cCQp=>{if(cCQp["isConfirmed"]){chrome["runtime"]["sendMessage"]({['message']:'openOptionsPage'});};});};function wxHp(){if(document["URL"]["includes"]('checkout.ticketmaster'))return document["URL"]["split"]('/')[(0O334664274-0x37368B9)]["split"]('?')[(0x75bcd15-0O726746425)];if(document["URL"]["includes"]('checkout.livenation'))return document["URL"]["split"]('/')[(0O334664274-0x37368B9)]["split"]('?')[(0x75bcd15-0O726746425)];if(document["URL"]["includes"]('ticketmaster.com/checkout')||document["URL"]["includes"]('ticketmaster.ca/checkout'))return cKes(document["URL"])['v'];if(document["URL"]["includes"]('livenation.com/checkout')||document["URL"]["includes"]('livenation.ca/checkout'))return cKes(document["URL"])['v']}async function YyKp(){const suBp=await MxGr(CHECKOUT_ID)["then"](UvEp=>{return UvEp[CHECKOUT_ID]});if(suBp?.["decisionReceived"]){UXFs(suBp["message"]);IOns(suBp["message"]);return !![]}return (NaN===NaN)}async function orvp(){const Qsyp=await MxGr(CHECKOUT_ID)["then"](QMlq=>{return QMlq[CHECKOUT_ID]});if(Qsyp?.["type"]=="confirmation"){const sOoq=await oLiq(CHECKOUT_ID);if(sOoq?.["decision"]){console["log"]('\x1b[47m%s\x1b[0m',`DECISION PRESENT. RARE EDGE CASE TRIGGERED.`);const MJfq={};MJfq[CHECKOUT_ID]={["type"]:"decision",["detailsSent"]:!![],["decisionReceived"]:!![],["message"]:sOoq["decision"]};await chrome["storage"]["local"]["set"](MJfq);UXFs(sOoq["decision"]);IOns(sOoq["decision"]);return !![]}UXFs("waiting");QUzs(Qsyp["message"]);return !![]}return (NaN===NaN)}async function oLiq(IGZp){return new Promise(async kIcq=>{chrome["runtime"]["sendMessage"]({['message']:'checkForDecision',['checkout_id']:IGZp},async EDTp=>{kIcq(EDTp)});});}function gFWp(){UXFs("error");cidp({["type"]:"warning",["message"]:"You are not connected to Decision Assistant. Please vitit the options page to connect, then refresh this page.",["showOptionsButton"]:!![]});}function gZJq(){if(document["URL"]["includes"]('checkout.ticketmaster'))return '[role="timer"]';if(document["URL"]["includes"]('ticketmaster.com/checkout')||document["URL"]["includes"]('ticketmaster.ca/checkout'))return '#timer-indicator';if(document["URL"]["includes"]('checkout.livenation'))return '[role="timer"]';if(document["URL"]["includes"]('livenation.com/checkout')||document["URL"]["includes"]('livenation.ca/checkout'))return '#timer-indicator'}function IaNq(cWDq){const EXGq=cWDq;const YSxq=EXGq["split"](':');const AUAq=parseInt(YSxq[(0x75bcd15-0O726746425)]);const UPrq=parseInt(YSxq[(0O57060516-0xbc614d)]);const wRuq=AUAq*60+UPrq;return wRuq}function Yqwn(Aszn){const Unqn=IaNq(Aszn["textContent"]);const wptn=Date["now"]()+Unqn*1000;console["log"]('\x1b[44m%s\x1b[0m',`Ends at: `,wptn);return wptn}function Qkkn(){console["log"]('\x1b[31m%s\x1b[0m',`Times up! Looks like you missed this one.`);MxGr('role')["then"](smnn=>{if(smnn["role"]=="puller"){UXFs("times_up");cidp({["type"]:"info",["message"]:"Times up! Looks like you missed this one."});};});};function Mhen(ojhn,oDUn){return Object["assign"]({},ojhn,oDUn);}globalThis["TICKET_DATA"]={};globalThis["CHECKOUT_ID"]=wxHp();globalThis["TIMER_SELECTOR"]=gZJq();globalThis["TOAST"]=null;Aoor();async function QEXn(){console["log"]('\x1b[45m%s\x1b[0m',`Initiating Main function for Decision Assistant...`);globalThis["PULLER_ID"]=await MxGr('puller_id')["then"](kAOn=>{return kAOn["puller_id"]});if(!PULLER_ID)return console["log"]('\x1b[43m%s\x1b[0m',`No puller ID found. Please log in to the extension to connect to the socket.`);const MBRn=await MxGr('testing')["then"](gxIn=>{return gxIn['testing']});if(MBRn){console["log"]('\x1b[44m%s\x1b[0m',`Running in testing mode... resetting storage variables!`);const IyLn={};IyLn[CHECKOUT_ID]={};await chrome["storage"]["local"]["set"](IyLn);}const cuCn=await YyKp();if(cuCn)return console["log"]("Decision was already received, notified user.");const EvFn=await MxGr('socket_connected')["then"](EPso=>{return EPso["socket_connected"]});if(!EvFn){gFWp();return;}const gRvo=await Bind["waitFor"](TIMER_SELECTOR)["then"](AMmo=>{const cOpo=IaNq(AMmo["textContent"]);console["log"]('\x1b[44m%s\x1b[0m',`Timer captured, time remaining: `,cOpo);if(cOpo===(0x75bcd15-0O726746425))return (NaN===NaN);TICKET_DATA=Mhen(TICKET_DATA,{['EndsAt']:Yqwn(AMmo)});return !![]});if(!gRvo){Qkkn();return;}const wJgo=await orvp();if(wJgo)return console["log"]("Details already sent, waiting...");QUzs("Collecting ticket data to send to Discord...",fadeIn=!![]);const YKjo={};YKjo[CHECKOUT_ID]={};await chrome["storage"]["local"]["set"](YKjo);const sGao=chrome["runtime"]["getURL"]('main/page_context/page_script.js');QAMr(sGao);Bind["waitFor"]('TDA[id="ticketData"]')["then"](UHdo=>{const UbRo=JSON["parse"](UHdo["getAttribute"]("ticketData"));TICKET_DATA=Mhen(TICKET_DATA,UbRo);TICKET_DATA=Mhen(TICKET_DATA,{['CheckOutId']:CHECKOUT_ID});saOo();UHdo["remove"]();});}globalThis["COUNTDOWN_TIMER"]=Bindly({['target']:globalThis["TIMER_SELECTOR"],['duplicate']:NaN===NaN,['onMutation']:wdUo=>{const QYKo=wdUo["mutation"]["target"]["nodeValue"];if(QYKo=="00:00")Qkkn();}});COUNTDOWN_TIMER["bind"]();async function saOo(){console["log"]('\x1b[34m%s\x1b[0m',`Initiating Phase 2 (sending details to Discord...)`);console["log"]("Ticket data: ",TICKET_DATA);const MVEo=await orvp();if(MVEo)return console["log"]("Details already sent, waiting...");chrome["runtime"]["sendMessage"]({['message']:'sendToDiscord',['pullerId']:PULLER_ID,['ticketData']:TICKET_DATA},async oXHo=>{console["log"]("Received response fom Lambda: ",oXHo);if(!oXHo["invokation_success"]){const ISyo={["type"]:"error",["message"]:oXHo["message"],["EndsAt"]:TICKET_DATA['EndsAt']};const kUBo=Iqxl(ISyo);await chrome["storage"]["local"]["set"](kUBo);return;};const MtDl={["type"]:"confirmation",["message"]:"Ticket details sent to Decision Assistant. Waiting for Discord...",["EndsAt"]:TICKET_DATA['EndsAt']};console["log"]('\x1b[32m%s\x1b[0m',`Status Info: `,MtDl);const ovGl=Iqxl(MtDl);await chrome["storage"]["local"]["set"](ovGl);return;});}function Iqxl(ksAl){const Enrl={};Enrl[CHECKOUT_ID]=ksAl;return Enrl}chrome["runtime"]["onMessage"]["addListener"](async function(gpul,Akll,cmol){if(gpul["message"]=='socketDisconnected'){console["log"]('\x1b[31m%s\x1b[0m',`SOCKET DISCONNECTED!`);const cGbm=await YyKp();if(cGbm)return console["log"]("Decision was already received, notified user. No reason to show them connection issue warning when the decision is already received.");gFWp();};if(gpul["message"]=='socketConnected'){console["log"]('\x1b[32m%s\x1b[0m',`SOCKET CONNECTED!`);if(globalThis["TOAST"]){try{globalThis["TOAST"]["close"]();}catch(EHem){console["error"](EHem)};}setTimeout(()=>{Aoor();},500);};});window["addEventListener"]('focus',async YCVl=>{console["log"]("Window focused");setTimeout(async()=>{const AEYl=document["querySelector"](".swal2-container");if(!AEYl){console["log"]('\x1b[45m%s\x1b[0m',`RESETTING!`);Aoor();}},500);});chrome["storage"]["local"]["onChanged"]["addListener"]((UzPl,wBSl)=>{for(key in UzPl){const QwJl=key;const syMl=wxHp();const sSzm=UzPl[key]["newValue"];if(QwJl!==syMl)return;if(sSzm["type"]=="error"){UXFs("error");cidp({["type"]:"error",["message"]:sSzm["message"]});};if(sSzm["type"]=="confirmation"){UXFs("waiting");QUzs(sSzm["message"]);};if(sSzm["type"]=="decision"){const UTCm=sSzm["message"];UXFs(UTCm);IOns(UTCm);};};});